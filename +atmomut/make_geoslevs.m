%MAKE_GEOSLEVS  Make a loadable Matlab file of GEOS ak and bks

% Author: Brad Weir
%
% Changelog:
%
% TODO:
% * Confirm correct values for eta72, etc.
%==============================================================================%

fname = ['geoslevs__', datestr(now,'yyyymmdd'), '.mat'];

% The below uses output in GSI_GridComp.rc, which has some errors, but closer
% than values used as input in dynamical core grid components, best way is
% to get them from fvcore_internal_rst from a run using those levels

eta72 = [   1  0.000000000000000E+000   1.00000000000000     ; ...
            2  4.804825782775879E-003  0.984951972961426     ; ...
            3  0.659375244140625       0.963406026363373     ; ...
            4   1.31348034667969       0.941865026950836     ; ...
            5   1.96131054687500       0.920387029647827     ; ...
            6   2.60920068359375       0.898908019065857     ; ...
            7   3.25708081054688       0.877429008483887     ; ...
            8   3.89820092773438       0.856018006801605     ; ...
            9   4.53390087890625       0.834660947322845     ; ...
           10   5.16961083984375       0.813303947448730     ; ...
           11   5.80532128906250       0.791946947574615     ; ...
           12   6.43626367187500       0.770637512207031     ; ...
           13   7.06219824218750       0.749378204345703     ; ...
           14   7.88342187500000       0.721165955066681     ; ...
           15   8.90999218750000       0.685899913311005     ; ...
           16   9.93652148437500       0.650634944438934     ; ...
           17   10.9181708984375       0.615818440914154     ; ...
           18   11.8958623046875       0.581041514873505     ; ...
           19   12.8695937500000       0.546304166316986     ; ...
           20   14.2909951171875       0.494590193033218     ; ...
           21   15.6259960937500       0.443740189075470     ; ...
           22   16.9608964843750       0.392891138792038     ; ...
           23   18.1618964843750       0.343381136655807     ; ...
           24   19.3096953125000       0.294403105974197     ; ...
           25   20.3258984375000       0.246741116046906     ; ...
           26   21.2149980468750       0.200350105762482     ; ...
           27   21.8775976562500       0.156224086880684     ; ...
           28   22.3898007812500       0.113602079451084     ; ...
           29   22.4363007812500       6.372006237506866E-002; ...
           30   21.6865019531250       2.801004052162170E-002; ...
           31   20.1192011718750       6.960024591535330E-003; ...
           32   17.6930039062500       8.175413235278484E-009; ...
           33   15.0393027343750       0.000000000000000E+000; ...
           34   12.7837031250000       0.000000000000000E+000; ...
           35   10.8663017578125       0.000000000000000E+000; ...
           36   9.23657226562500       0.000000000000000E+000; ...
           37   7.85123144531250       0.000000000000000E+000; ...
           38   6.66034130859375       0.000000000000000E+000; ...
           39   5.63879101562500       0.000000000000000E+000; ...
           40   4.76439111328125       0.000000000000000E+000; ...
           41   4.01754101562500       0.000000000000000E+000; ...
           42   3.38100073242187       0.000000000000000E+000; ...
           43   2.83678051757812       0.000000000000000E+000; ...
           44   2.37304052734375       0.000000000000000E+000; ...
           45   1.97916040039063       0.000000000000000E+000; ...
           46   1.64571032714844       0.000000000000000E+000; ...
           47   1.36434020996094       0.000000000000000E+000; ...
           48   1.12769018554688       0.000000000000000E+000; ...
           49  0.929294189453125       0.000000000000000E+000; ...
           50  0.761984191894531       0.000000000000000E+000; ...
           51  0.621680114746094       0.000000000000000E+000; ...
           52  0.504680114746094       0.000000000000000E+000; ...
           53  0.407657104492188       0.000000000000000E+000; ...
           54  0.327643066406250       0.000000000000000E+000; ...
           55  0.262021057128906       0.000000000000000E+000; ...
           56  0.208497039794922       0.000000000000000E+000; ...
           57  0.165079025268555       0.000000000000000E+000; ...
           58  0.130051025390625       0.000000000000000E+000; ...
           59  0.101944023132324       0.000000000000000E+000; ...
           60  7.951341247558594E-002  0.000000000000000E+000; ...
           61  6.167790985107422E-002  0.000000000000000E+000; ...
           62  4.758060836791992E-002  0.000000000000000E+000; ...
           63  3.650410842895508E-002  0.000000000000000E+000; ...
           64  2.785260581970215E-002  0.000000000000000E+000; ...
           65  2.113490295410156E-002  0.000000000000000E+000; ...
           66  1.594950294494629E-002  0.000000000000000E+000; ...
           67  1.197030162811279E-002  0.000000000000000E+000; ...
           68  8.934501647949220E-003  0.000000000000000E+000; ...
           69  6.600001335144043E-003  0.000000000000000E+000; ...
           70  4.758501052856446E-003  0.000000000000000E+000; ...
           71  3.270000457763672E-003  0.000000000000000E+000; ...
           72  2.000000238418579E-003  0.000000000000000E+000; ...
           73  1.000000000000000E-003  0.000000000000000E+000];

ak72 = 1e3*eta72(:,2);
bk72 =     eta72(:,3);


disp(['Saving level data to ', fname, ' ...']);
save(fname, 'ak72', 'bk72');
